<ion-header class="ion-border">
  <ion-toolbar>
    <ion-button slot="start" fill="clear" size="small" (click)="back()" > 
      <ion-icon style="color:#FC9C4C; font-size: 2rem;" name="chevron-back-outline"></ion-icon>
    </ion-button>
    <ion-title style="color: black;">Member</ion-title>
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true">

  <ion-grid class="slider-menu">

    <div class="arrow-left">
      <ion-button fill="clear" size="small" slot="icon-only" (click)="moveLeft()">
        <ion-icon style="color: #424242; font-size: 2rem ;" name="chevron-back-outline"></ion-icon>
      </ion-button>
    </div>

    <ion-grid class="card-container">


      <div class="slider-container">


        <ion-card class="slider-item" style="border: 3px solid #c5ad92;">
          <ion-card-header>

            <div style="position: relative; width: 100%;">
              <div style="position: absolute; width: 100%;">
                <div style="position: relative; left: -5rem;">
                  <div style="display: flex; justify-content: left; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white; border: 1rem solid #dac7b3; border-radius: 50%;"></div>
                  </div>
                </div>
                <div style="position: relative; right: -5rem;">
                  <div style="display: flex; justify-content: right; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white ; border: 1rem solid #dac7b3; border-radius: 50%;"></div>
                  </div>
                </div>
              </div>
            </div>

            <ion-icon style="color: #a37541;" name="cube-outline"></ion-icon>
            <ion-card-title>Bronze</ion-card-title>
            <ion-card-subtitle>
              Price: {{ getPrice('Bronze') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
            <ion-card-subtitle>
              Sale Price: {{ getSalePrice('Bronze') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
          </ion-card-header>
          <ion-card-content>
            <ion-button (click)="openModal()" style="--background: #a37541; color: white;" (click)="selectPackage('Bronze')">
              Choose Bronze
            </ion-button>
          </ion-card-content>
        </ion-card>


      </div>

      <div class="slider-container">
        <ion-card class="slider-item" style="border: 3px solid #21C3E3;">
          <ion-card-header>

            <div style="position: relative; width: 100%;">
              <div style="position: absolute; width: 100%;">
                <div style="position: relative; right: -5rem; top: -2rem;">
                  <div style="display: flex; justify-content: right; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white; border: 1rem solid #C5F0FF; border-radius: 50%;"></div>
                  </div>
                </div>
                <div style="position: relative; left: -5rem;">
                  <div style="display: flex; justify-content: left; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white ; border: 1rem solid #C5F0FF; border-radius: 50%;"></div>
                  </div>
                </div>
              </div>
            </div>

            <ion-icon style="color: #21C3E3;" name="cube-outline"></ion-icon>
            <ion-card-title>Silver</ion-card-title>
            <ion-card-subtitle>
              Price: {{ getPrice('Silver') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
            <ion-card-subtitle>
              Sale Price: {{ getSalePrice('Silver') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
          </ion-card-header>
          <ion-card-content>
            <ion-button  (click)="openModal()" style="--background: #21c3e3; color: white;" (click)="selectPackage('Silver')">
              Choose Silver
            </ion-button>
          </ion-card-content>
        </ion-card>
      </div>

      <div class="slider-container">
        <ion-card class="slider-item" style="border: 3px solid #FEBB4B;">
          <ion-card-header>

            <div style="position: relative; width: 100%;">
              <div style="position: absolute; width: 100%;">
                <div style="position: relative; left: -4rem; top: -2rem;">
                  <div style="display: flex; justify-content: left; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white; border: 1rem solid #FCE2CB; border-radius: 50%;"></div>
                  </div>
                </div>
                <div style="position: relative; right: -5rem; bottom: -2rem;">
                  <div style="display: flex; justify-content: right; width: 100%;">
                    <div style="width: 5rem; height: 5rem; background-color: white ; border: 1rem solid #FCE2CB; border-radius: 50%;"></div>
                  </div>
                </div>
              </div>
            </div>

            <ion-icon style="color: #FEBB4B;" name="cube-outline"></ion-icon>
            <ion-card-title>Gold</ion-card-title>
            <ion-card-subtitle>
              Price: {{ getPrice('Gold') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
            <ion-card-subtitle>
              Sale Price: {{ getSalePrice('Gold') | currency:'IDR':'symbol':'1.0-0' }}
            </ion-card-subtitle>
          </ion-card-header>
          <ion-card-content>
            <ion-button (click)="openModal()" style="--background: #febb4b; color: white;" (click)="selectPackage('Gold')">
              Choose Gold
            </ion-button>
          </ion-card-content>
        </ion-card>
      </div>

    </ion-grid>

    <div class="arrow-right">
      <ion-button fill="clear" size="small" slot="icon-only" (click)="moveRight()">
        <ion-icon style="color: #424242; font-size: 2rem;" name="chevron-forward-outline"></ion-icon>
      </ion-button>
    </div>

  </ion-grid>





  <ion-modal #myModal [isOpen]="isModalOpen" (didDismiss)="closeModal()">
    <ng-template>
      <ion-content>

 
        <div class="register-form" *ngIf="!isOtpSent">

          <ion-header>
            <ion-button slot="start" fill="clear" size="small" (click)="closeModal()" > 
              <ion-icon style="color:#FC9C4C; font-size: 2rem;" name="chevron-back-outline"></ion-icon>
            </ion-button>
            <ion-title style="color: black;">Registrasi</ion-title>
          </ion-header>

          <div class="img">
            <img src="assets/otatea-logo.png" alt="">
          </div>
          <!-- <ion-title>Register</ion-title> -->
          <div class="form-container">

              <ion-grid class="input-container">
                <ion-icon name="person-outline"></ion-icon>
                <ion-input [(ngModel)]="name" type="text" label="Name" label-placement="floating" required></ion-input>
              </ion-grid>

              <ion-grid class="input-container">
                <ion-icon name="pin-outline"></ion-icon>
                <ion-input [(ngModel)]="address" type="text" label="Address" label-placement="floating" required></ion-input>
              </ion-grid>

              <ion-grid class="input-container">
                <ion-icon name="call-outline"></ion-icon>
                <ion-input [(ngModel)]="phone" (input)="validatePhoneNumber($event)" type="text" label="Phone Number" label-placement="floating" required></ion-input>
              </ion-grid>

              <div class="btn">
                <ion-button expand="block" (click)="register()">Register</ion-button>
              </div>
              
          </div>
          
          <!-- <div style="position: absolute; bottom: 0; right: 0; left: 0;">
            
            
            <ion-grid class="bottom-circle-container">
              <ion-grid class="bottom-circle">
                <ion-grid class="bottom-circle-inside"></ion-grid>
              </ion-grid>
            </ion-grid>
            
            
            <div class="footer"></div>
            
          </div> -->
      </div>

        
      <div class="verif-otp" *ngIf="isOtpSent && !otpVerify">

          <ion-header>
            <ion-title style="color: black;">Verifikasi OTP</ion-title>
          </ion-header>
  
        
        <ion-grid>

          <div class="otp-container">

            <p class="otp-title">Enter the 6 digit verification code</p>
            <!-- <p class="otp-subtitle">Kode telah dikirim ke nomor <strong>{{ formattedPhone }}</strong></p> -->
        
            <div class="otp-inputs">
              <input #otp1 type="text" maxlength="1" (input)="moveToNext($event, otp2)" (keydown)="handleBackspace($event, otp1)" [(ngModel)]="otp[0]">
              <input #otp2 type="text" maxlength="1" (input)="moveToNext($event, otp3)" (keydown)="handleBackspace($event, otp1, otp2)" [(ngModel)]="otp[1]">
              <input #otp3 type="text" maxlength="1" (input)="moveToNext($event, otp4)" (keydown)="handleBackspace($event, otp2, otp3)" [(ngModel)]="otp[2]">
              <input #otp4 type="text" maxlength="1" (input)="moveToNext($event, otp5)" (keydown)="handleBackspace($event, otp3, otp4)" [(ngModel)]="otp[3]">
              <input #otp5 type="text" maxlength="1" (input)="moveToNext($event, otp6)" (keydown)="handleBackspace($event, otp4, otp5)" [(ngModel)]="otp[4]">
              <input #otp6 type="text" maxlength="1" (input)="verifyOtp()" (keydown)="handleBackspace($event, otp5, otp6)" [(ngModel)]="otp[5]">
            </div>
        
            <div class="btn">
              <ion-button expand="block" shape="round" (click)="verifyOtp()">
                <ion-title >Verifikasi OTP</ion-title>
              </ion-button>
            </div>
        
            <p class="resend-text">
              <ion-button fill="clear" (click)="resendOtp()" [disabled]="otpCooldownRemaining > 0">
                <ion-title>Resend OTP ({{ otpCooldownRemaining }}s)</ion-title>
              </ion-button>
            </p>
          </div>
        </ion-grid>
        

      </div>


        <div class="pembayaran" *ngIf="selectedPackage && otpVerify && !isPaid">
          <ion-grid>

            
            <ion-header>
              <ion-title style="color: black;">Payment</ion-title>
            </ion-header>
            
            <ion-title class="text">*Selesaikan Pembayaran untuk Melanjutkan.</ion-title>

            <ion-grid>
              

              <div class="pay-form">
                <ion-radio-group [(ngModel)]="paymentMethod" value="creditCard">
                    <ion-label>Credit Card</ion-label>
                    <ion-radio slot="end" value="creditCard"></ion-radio>
                </ion-radio-group>
              </div>

              <div class="card-pay" *ngIf="paymentMethod === 'creditCard'">
                <ion-title>Lengkapi Data</ion-title>
                <ion-grid>
                  <div style="border-bottom: 1px solid #424242;">
                    <ion-label>Card Type</ion-label>
                    <ion-select [(ngModel)]="cardType" placeholder=" " slot="end">
                      <ion-select-option value="visa">Visa</ion-select-option>
                      <ion-select-option value="masterCard">MasterCard</ion-select-option>
                      <ion-select-option value="discover">Discover</ion-select-option>
                    </ion-select>
                  </div>
                  <div>
                    <ion-label>Card Number :</ion-label>
                    <ion-input type="text" [(ngModel)]="cardNumber"></ion-input>
                  </div>
                </ion-grid>
              </div>


              <div class="pay-form">
                <ion-radio-group [(ngModel)]="paymentMethod" value="paypal">
                    <ion-label>PayPal</ion-label>
                    <ion-radio slot="end" value="paypal"></ion-radio>
                </ion-radio-group>
              </div>

              <div class="paypal-pay" *ngIf="paymentMethod === 'paypal'">
                <ion-title>Lengkapi Data</ion-title>
                <div>
                  <ion-label>PayPal Payment ID :</ion-label>
                  <ion-input type="text" [(ngModel)]="paymentId" placeholder=""></ion-input>
                </div>
              </div>



              <div class="pay-form">
                <ion-radio-group [(ngModel)]="paymentMethod" value="dana">
                    <ion-label>Dana</ion-label>
                    <ion-radio slot="end" value="dana"></ion-radio>
                </ion-radio-group>
              </div>

              <div class="dana-pay" *ngIf="paymentMethod === 'dana'">
                <ion-title>Lengkapi Data</ion-title>
                <div>
                  <ion-label>Dana Payment ID :</ion-label>
                  <ion-input type="text" [(ngModel)]="paymentId" placeholder=""></ion-input>
                </div>
              </div>

            </ion-grid>
          </ion-grid>

        </div>

        <div class="alert-after-pay" *ngIf="isPaid">
          <ion-grid>

            <div>
              <ion-icon name="checkmark-outline"></ion-icon>
            </div>

            <div class="txt">
              <ion-title>Success</ion-title>
              <p>Your payment was successful, thank you for choosing us. Please log in using the data we sent via OTP.</p>
            </div>

            <div class="btn">
              <ion-button expand="block" (click)="closeModal()" >Next</ion-button>
            </div>
          </ion-grid>
        </div>

      </ion-content>

       



      <ion-footer *ngIf="selectedPackage && otpVerify && !isPaid">
        <ion-toolbar>

          <div>
            <ion-title>Total</ion-title>
            <ion-title>{{ selectedPackage.sale_price | currency:'IDR':'symbol':'1.0-0' }}</ion-title>
          </div>

          <div class="btn">
            <ion-button expand="block" (click)="payForPackage()"><ion-title>Pay Now</ion-title></ion-button>
          </div>

        </ion-toolbar>
      </ion-footer>

    </ng-template>
  </ion-modal>



  <div style="position: absolute; bottom: 0; right: 0; left: 0;">


      <ion-grid class="bottom-circle-container">
        <ion-grid class="bottom-circle">
          <ion-grid class="bottom-circle-inside"></ion-grid>
        </ion-grid>
      </ion-grid>


      <div class="footer"></div>

  </div>



</ion-content>
