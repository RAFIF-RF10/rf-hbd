"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2660],{2660:(j,d,l)=>{l.r(d),l.d(d,{KeranjangPageModule:()=>b});var g=l(177),p=l(4341),m=l(4742),s=l(7291),_=l(467),h=l(7464),n=l(4438),C=l(6868);function P(a,r){1&a&&(n.j41(0,"div",22),n.nrm(1,"img",23),n.j41(2,"ion-title"),n.EFF(3,"Keranjang Anda Kosong."),n.k0s()())}function M(a,r){if(1&a){const c=n.RV6();n.j41(0,"ion-card",24)(1,"div",25)(2,"ion-checkbox",26),n.mxI("ngModelChange",function(t){const o=n.eBV(c).$implicit;return n.DH7(o.selected,t)||(o.selected=t),n.Njj(t)}),n.bIt("ionChange",function(t){const o=n.eBV(c).$implicit,i=n.XpG();return n.Njj(i.toggleSelection(o,t))}),n.k0s(),n.j41(3,"ion-thumbnail",27)(4,"img",28),n.bIt("error",function(t){n.eBV(c);const o=n.XpG();return n.Njj(o.setDefaultImage(t))}),n.k0s()(),n.j41(5,"ion-grid")(6,"ion-title"),n.EFF(7),n.k0s(),n.j41(8,"ion-title"),n.EFF(9),n.nI1(10,"currency"),n.k0s(),n.j41(11,"div",29)(12,"button",30),n.bIt("click",function(){const t=n.eBV(c).$implicit,o=n.XpG();return n.Njj(o.decreaseQty(t))}),n.EFF(13,"-"),n.k0s(),n.j41(14,"ion-label"),n.EFF(15),n.k0s(),n.j41(16,"button",30),n.bIt("click",function(){const t=n.eBV(c).$implicit,o=n.XpG();return n.Njj(o.increaseQty(t))}),n.EFF(17,"+"),n.k0s()()(),n.j41(18,"ion-button",31),n.bIt("click",function(){const t=n.eBV(c).$implicit,o=n.XpG();return n.Njj(o.removeItem(t))}),n.nrm(19,"ion-icon",32),n.k0s()()()}if(2&a){const c=r.$implicit,e=n.XpG();n.R7$(2),n.Y8G("checked",e.selectedItems.includes(c)),n.R50("ngModel",c.selected),n.R7$(2),n.FS9("alt",c.name),n.Y8G("src",c.img_url,n.B4B),n.R7$(3),n.JRh(c.name),n.R7$(2),n.Lme("",n.i5U(10,8,c.price,"Rp. ")," x ",c.qty,""),n.R7$(6),n.JRh(c.qty)}}const O=[{path:"",component:(()=>{var a;class r{constructor(e,t,o){this.router=e,this.cartService=t,this.alertController=o,this.cartItems=[],this.selectedItems=[],this.selectAllChecked=!1,this.paymentMethod="",this.paymentOptions=["CA","VA","TF","DC"],this.deliveryOption="pickup",this.discount=0,this.gst=0,this.customer_name="",this.customer_phone=""}ngOnInit(){this.cartItems=this.cartService.getCartItems(),console.log("Nilai awal paymentMethod:",this.paymentMethod)}presentAlert(e,t){var o=this;return(0,_.A)(function*(){yield(yield o.alertController.create({header:e,message:t,buttons:["OK"]})).present()})()}toggleSelection(e,t){t.target.checked?this.selectedItems.push(e):this.selectedItems=this.selectedItems.filter(o=>o!==e),this.updateSelectAllStatus()}toggleSelectAll(e){this.selectAllChecked=e.target.checked,this.selectedItems=this.selectAllChecked?[...this.cartItems]:[]}updateSelectAllStatus(){this.selectAllChecked=this.cartItems.length>0&&this.selectedItems.length===this.cartItems.length}calculateSubtotal(){return this.selectedItems.reduce((e,t)=>e+t.price*t.qty,0)}calculateTotal(){return this.gst=.1*this.calculateSubtotal(),this.calculateSubtotal()-this.discount+this.gst}getItemCount(){return this.cartItems.reduce((e,t)=>e+t.qty,0)}increaseQty(e){e.qty++}decreaseQty(e){e.qty>1&&e.qty--}onCustomerNameChange(e){const t=e.target;if(t){const o=t.value.trim();this.customer_name=o.length>0?o:""}}onCustomerPhoneChange(e){const t=e.target;if(t){let o=t.value.replace(/\D/g,"");o.startsWith("0")||(o="0"+o),o.length>16&&(o=o.slice(0,16)),this.customer_phone=o,t.value=o}}pay(){var e=this;return(0,_.A)(function*(){if(0===e.selectedItems.length)return void e.presentAlert("Perhatian","Pilih setidaknya satu item sebelum melakukan pembayaran!");const t=JSON.parse(localStorage.getItem("user_data")||"{}");if(!e.paymentMethod)return void e.presentAlert("Perhatian","Pilih metode pembayaran sebelum melanjutkan!");if(!t||!e.customer_name||!e.customer_phone)return void e.presentAlert("Perhatian","Silakan isi nama dan nomor telepon pelanggan!");const o={id_outlet:t.userData.id_outlet,customer_name:e.customer_name,customer_phone:e.customer_phone,customer_payment_total:e.calculateTotal(),customer_payment_method:e.paymentMethod,customer_payment_detail:e.selectedItems.map(i=>({name:i.name,price:i.price,qty:i.qty}))};try{const u=(yield h.pX.post({url:"https://epos.pringapus.com/api/v1/cart/checkout",data:o,headers:{"Content-Type":"application/json"}})).data;u.status?(e.presentAlert("Sukses","Pembayaran berhasil! Pesanan Anda telah diterima."),e.cartService.setRefreshRiwayat(),e.selectedItems.forEach(k=>e.cartService.removeItem(k)),e.cartItems=e.cartService.getCartItems(),e.selectedItems=[],e.paymentMethod="",e.customer_name="",e.customer_phone="",e.selectAllChecked=!1):e.presentAlert("Gagal","Gagal melakukan pembayaran: "+u.message)}catch(i){console.error("Terjadi kesalahan:",i),e.presentAlert("Error","Terjadi kesalahan saat memproses pembayaran.")}})()}removeItem(e){this.cartService.removeItem(e),this.cartItems=this.cartService.getCartItems(),this.selectedItems=this.selectedItems.filter(t=>t!==e),this.updateSelectAllStatus()}onPaymentMethodChange(e){console.log("Metode pembayaran dipilih:",this.paymentMethod)}setDefaultImage(e){e.target.src="assets/image-not-found.png"}}return(a=r).\u0275fac=function(e){return new(e||a)(n.rXU(s.Ix),n.rXU(C.m),n.rXU(m.hG))},a.\u0275cmp=n.VBU({type:a,selectors:[["app-keranjang"]],decls:73,vars:24,consts:[["slot","start","fill","clear","size","small",3,"click"],["name","chevron-back-outline",2,"color","#FC9C4C","font-size","2rem"],[2,"color","black"],[1,"pilih-semua"],["labelPlacement","end","slot","start",3,"ionChange","checked"],["class","no-found",4,"ngIf"],["class","item-card",4,"ngFor","ngForOf"],[1,"metode-card"],["color","warning","placeholder","Pilih Metode","interface","action-sheet","slot","end",3,"ionChange","value"],["value","CA"],["value","VA"],["value","TF"],["value","DC"],[1,"customer-info-card"],["label","Nama Pelanggan","label-placement","floating","type","text",3,"ngModelChange","ionInput","ngModel"],["label","Nomor Telepon","label-placement","floating","type","tel",3,"ngModelChange","ionInput","ngModel"],[1,"option-card"],["color","warning",3,"ngModelChange","ngModel"],["value","takeaway"],["value","delivery"],["size","6"],["expand","block",3,"click"],[1,"no-found"],["src","assets/empty-cart.png","alt","anajy "],[1,"item-card"],[1,"main"],["slot","start",3,"ngModelChange","ionChange","checked","ngModel"],["slot","start"],[3,"error","src","alt"],[1,"increment"],[3,"click"],["slot","end","fill","clear",3,"click"],["name","trash-outline"]],template:function(e,t){1&e&&(n.j41(0,"ion-header")(1,"ion-button",0),n.bIt("click",function(){return t.router.navigate(["tab/home"])}),n.nrm(2,"ion-icon",1),n.k0s(),n.j41(3,"ion-title",2),n.EFF(4),n.k0s()(),n.j41(5,"ion-content")(6,"div",3)(7,"ion-checkbox",4),n.bIt("ionChange",function(i){return t.toggleSelectAll(i)}),n.k0s(),n.j41(8,"ion-title"),n.EFF(9,"* Pilih Semua"),n.k0s()(),n.DNE(10,P,4,0,"div",5)(11,M,20,11,"ion-card",6),n.j41(12,"ion-card",7)(13,"div")(14,"ion-title"),n.EFF(15,"*Metode Pembayaran"),n.k0s(),n.j41(16,"ion-select",8),n.bIt("ionChange",function(i){return t.paymentMethod=i.detail.value,t.onPaymentMethodChange(i)}),n.j41(17,"ion-select-option",9),n.EFF(18,"Cash"),n.k0s(),n.j41(19,"ion-select-option",10),n.EFF(20,"Virtual Account"),n.k0s(),n.j41(21,"ion-select-option",11),n.EFF(22,"Transfer"),n.k0s(),n.j41(23,"ion-select-option",12),n.EFF(24,"Debet/Credit Card"),n.k0s()()()(),n.j41(25,"ion-card",13)(26,"ion-grid")(27,"ion-row")(28,"div")(29,"ion-input",14),n.mxI("ngModelChange",function(i){return n.DH7(t.customer_name,i)||(t.customer_name=i),i}),n.bIt("ionInput",function(i){return t.onCustomerNameChange(i)}),n.k0s()(),n.j41(30,"div")(31,"ion-input",15),n.mxI("ngModelChange",function(i){return n.DH7(t.customer_phone,i)||(t.customer_phone=i),i}),n.bIt("ionInput",function(i){return t.onCustomerPhoneChange(i)}),n.k0s()()()()(),n.j41(32,"ion-card",16)(33,"ion-title"),n.EFF(34,"*Opsi Pengiriman"),n.k0s(),n.j41(35,"div")(36,"ion-segment",17),n.mxI("ngModelChange",function(i){return n.DH7(t.deliveryOption,i)||(t.deliveryOption=i),i}),n.j41(37,"ion-segment-button",18),n.EFF(38,"Takeaway"),n.k0s(),n.j41(39,"ion-segment-button",19),n.EFF(40,"Delivery"),n.k0s()()()()(),n.j41(41,"ion-footer")(42,"ion-toolbar")(43,"ion-grid")(44,"ion-row")(45,"ion-col",20)(46,"ion-label"),n.EFF(47,"Subtotal: "),n.k0s(),n.j41(48,"ion-title"),n.EFF(49),n.nI1(50,"currency"),n.k0s()(),n.j41(51,"ion-col",20)(52,"ion-label"),n.EFF(53,"Diskon:"),n.k0s(),n.j41(54,"ion-title"),n.EFF(55),n.nI1(56,"currency"),n.k0s()()(),n.j41(57,"ion-row")(58,"ion-col",20)(59,"ion-label"),n.EFF(60,"GST (10%): "),n.k0s(),n.j41(61,"ion-title"),n.EFF(62),n.nI1(63,"currency"),n.k0s()(),n.j41(64,"ion-col",20)(65,"ion-label"),n.EFF(66,"Total:"),n.k0s(),n.j41(67,"ion-title"),n.EFF(68),n.nI1(69,"currency"),n.k0s()()(),n.j41(70,"ion-button",21),n.bIt("click",function(){return t.pay()}),n.j41(71,"ion-title"),n.EFF(72,"Bayar"),n.k0s()()()()()),2&e&&(n.R7$(4),n.SpI("Keranjang Saya (",t.getItemCount(),") "),n.R7$(3),n.Y8G("checked",t.selectAllChecked),n.R7$(3),n.Y8G("ngIf",0===t.cartItems.length),n.R7$(),n.Y8G("ngForOf",t.cartItems),n.R7$(5),n.Y8G("value",t.paymentMethod),n.R7$(13),n.R50("ngModel",t.customer_name),n.R7$(2),n.R50("ngModel",t.customer_phone),n.R7$(5),n.R50("ngModel",t.deliveryOption),n.R7$(13),n.SpI(" ",n.i5U(50,12,t.calculateSubtotal(),"Rp. "),""),n.R7$(6),n.SpI(" ",n.i5U(56,15,t.discount,"Rp. "),""),n.R7$(7),n.SpI(" ",n.i5U(63,18,t.gst,"Rp. "),""),n.R7$(6),n.SpI(" ",n.i5U(69,21,t.calculateTotal(),"Rp. "),""))},dependencies:[g.MD,g.Sq,g.bT,g.oe],styles:["ion-header[_ngcontent-%COMP%]{background:#fff;padding:20px 0;display:flex;flex-direction:column;justify-content:center;align-items:center}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:700;font-size:larger;text-align:center}ion-header[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: none;position:absolute;left:1rem}ion-content[_ngcontent-%COMP%]{--background: white}ion-content[_ngcontent-%COMP%]   .pilih-semua[_ngcontent-%COMP%]{display:flex;width:100%;padding:1.5rem;gap:6px}ion-content[_ngcontent-%COMP%]   .pilih-semua[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--size: 18px;--checkbox-background: white;--checkbox-background-checked: #febb4b;color:#fff;background:#fff}ion-content[_ngcontent-%COMP%]   .pilih-semua[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:3px;border:2px solid #febb4b}ion-content[_ngcontent-%COMP%]   .pilih-semua[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#777676;font-size:medium;padding:0}ion-content[_ngcontent-%COMP%]   .no-found[_ngcontent-%COMP%]{background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:2rem}ion-content[_ngcontent-%COMP%]   .no-found[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70%}ion-content[_ngcontent-%COMP%]   .no-found[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{--color: #424242;font-weight:500;font-size:medium;font-family:Poppins}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]{--background: white;margin:1rem}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{width:100%;display:flex;gap:15px;justify-content:space-between;align-items:center;padding:1rem 1.5rem}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--size: 23px;--checkbox-background: white;--checkbox-background-checked: #febb4b;color:#fff;background:#fff}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:3px;border:2px solid #febb4b}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#424242;font-size:medium;font-weight:700;padding:0 0 5px}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]:nth-child(2){color:#8d8d8d;font-size:x-small;padding:0}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   .increment[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-top:1rem}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   .increment[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;color:#fff;width:20px;height:20px;border-radius:5px;display:flex;justify-content:center;align-items:center;background:#febb4b;font-weight:700;font-size:medium}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   .increment[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#424242}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgb(255, 82, 82);--border-radius: 10px}ion-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}ion-content[_ngcontent-%COMP%]   .metode-card[_ngcontent-%COMP%]{--background: white;margin:3rem 1rem 1rem;border-radius:15px}ion-content[_ngcontent-%COMP%]   .metode-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;width:100%;padding:1rem 3rem;justify-content:center;gap:2rem}ion-content[_ngcontent-%COMP%]   .metode-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:medium;padding:0;color:#cf8f24}ion-content[_ngcontent-%COMP%]   .metode-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{color:#424242}ion-content[_ngcontent-%COMP%]   .customer-info-card[_ngcontent-%COMP%]{--background: white;margin:1rem;border-radius:15px}ion-content[_ngcontent-%COMP%]   .customer-info-card[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding:1rem}ion-content[_ngcontent-%COMP%]   .customer-info-card[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{--background: white;color:#424242;width:100%}ion-content[_ngcontent-%COMP%]   .customer-info-card[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{padding:1rem}ion-content[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]{--background: white;margin:1rem;border-radius:15px}ion-content[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:medium;padding:1rem 1.5rem;color:#cf8f24}ion-content[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;width:100%;padding:0 1rem 1rem;justify-content:center;gap:2rem}ion-content[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{color:#424242}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: white;--color: #424242;padding:1rem 1.5rem 1.5rem}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:10px 2rem}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding:0;font-size:small}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:small;color:#777676}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: #cf8f24;--border-radius: 10px;margin-top:10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{--color: white;font-size:medium}"]}),r})()}];let f=(()=>{var a;class r{}return(a=r).\u0275fac=function(e){return new(e||a)},a.\u0275mod=n.$C({type:a}),a.\u0275inj=n.G2t({imports:[s.iI.forChild(O),s.iI]}),r})(),b=(()=>{var a;class r{}return(a=r).\u0275fac=function(e){return new(e||a)},a.\u0275mod=n.$C({type:a}),a.\u0275inj=n.G2t({imports:[g.MD,p.YN,m.bv,f]}),r})()}}]);