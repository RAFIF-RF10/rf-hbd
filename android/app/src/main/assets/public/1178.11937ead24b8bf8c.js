"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1178],{1178:(M,h,a)=>{a.r(h),a.d(h,{LoginPageModule:()=>w});var f=a(177),d=a(4341),s=a(4742),m=a(7291),g=a(467),u=a(7464);const k=(0,u.F3)("Device",{web:()=>a.e(8622).then(a.bind(a,8622)).then(o=>new o.DeviceWeb)});var e=a(4438),b=a(8556);const P=[{path:"",component:(()=>{var o;class l{constructor(t,n,r){this.router=t,this.storageService=n,this.alertController=r,this.outlet_code="",this.username="",this.password="",this.fullName="",this.email="",this.registerPassword="",this.deviceToken="",this.showRegisterPassword=!1,this.showPassword=!1,this.showRegisterForm=!1,this.getDeviceToken()}presentAlert(t,n){var r=this;return(0,g.A)(function*(){yield(yield r.alertController.create({header:t,message:n,buttons:["OK"]})).present()})()}getDeviceToken(){var t=this;return(0,g.A)(function*(){const n=yield k.getId();t.deviceToken=n.identifier})()}Login(){var t=this;return(0,g.A)(function*(){if(!t.outlet_code||!t.username||!t.password)return void t.presentAlert("Perhatian","Form harus diisi dengan lengkap");const n={outlet_code:t.outlet_code,username:t.username,password:t.password,device_token:t.deviceToken};try{const i=yield u.pX.post({url:"https://epos.pringapus.com/api/v1/Authentication/getUserLogin",data:n,headers:{"Content-Type":"application/json"}});if(console.log(i),200===i.status){const p=i.data.data;if(i.data.forceLogout)return void(yield(yield t.alertController.create({header:"Peringatan",message:"Akun ini sedang digunakan di perangkat lain. Apakah Anda ingin melogout perangkat sebelumnya?",buttons:[{text:"Tidak",role:"cancel",handler:()=>{console.log("User membatalkan login")}},{text:"Ya, Logout Perangkat Lama",handler:(y=(0,g.A)(function*(){yield t.forceLogout(p.deviceToken),t.Login()}),function(){return y.apply(this,arguments)})}]})).present());localStorage.setItem("user_data",JSON.stringify(p)),localStorage.setItem("access_token",p.accessToken),localStorage.setItem("device_token",p.deviceToken),t.router.navigate(["/tab/home"])}else{var r;t.presentAlert("Gagal Login","Gagal login: "+((null===(r=i.data)||void 0===r?void 0:r.message)||"Unknown error"))}}catch(i){console.error("HTTP request error:",i),t.presentAlert("Error","Kesalahan dalam melakukan permintaan: "+i.message)}var y})()}forceLogout(t){var n=this;return(0,g.A)(function*(){try{yield u.pX.post({url:"https://epos.pringapus.com/api/v1/Authentication/forceLogout",data:{device_token:t},headers:{"Content-Type":"application/json"}}),localStorage.clear(),n.router.navigate(["/login"])}catch(r){console.error("Gagal logout perangkat lama:",r)}})()}ionViewWillEnter(){var t=this;setInterval((0,g.A)(function*(){const n=localStorage.getItem("device_token");(yield u.pX.post({url:"https://epos.pringapus.com/api/v1/Authentication/checkDeviceToken",data:{device_token:n},headers:{"Content-Type":"application/json"}})).data.valid||(t.presentAlert("Sesi Berakhir","Silahkan login kembali."),localStorage.clear(),t.router.navigate(["/login"]))}),5e3)}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleRegisterPasswordVisibility(){this.showRegisterPassword=!this.showRegisterPassword}openRegisterForm(){this.showRegisterForm=!0}closeRegisterForm(){this.showRegisterForm=!1}register(){console.log("User registered:",this.fullName,this.email,this.registerPassword),this.router.navigate(["register"])}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(m.Ix),e.rXU(b.n),e.rXU(s.hG))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-login"]],standalone:!1,decls:32,vars:5,consts:[[1,"banner"],[1,"top-circle-container"],[1,"top-circle"],[1,"top-circle-inside"],[1,"img"],["src","assets/otatea-logo.png","alt",""],[2,"background","#febb4b","margin","0","padding","0","--position","relative"],[1,"login-container"],[1,"input-container"],["name","storefront-outline"],["type","text","label","Outlet Code","label-placement","floating","required","",3,"ngModelChange","ngModel"],["name","person-outline"],["type","text","label","Username","label-placement","floating","required","",3,"ngModelChange","ngModel"],["name","key-outline"],["label","Password","label-placement","floating","required","",3,"ngModelChange","ngModel","type"],["slot","end",2,"cursor","pointer",3,"click","name"],[1,"input-btn",3,"click"],[1,"register-link"],["fill","clear",3,"click"],[1,"bottom-circle-container"],[1,"bottom-circle"],[1,"bottom-circle-inside"],[1,"footer"]],template:function(t,n){1&t&&(e.j41(0,"ion-content")(1,"ion-grid",0)(2,"ion-grid",1)(3,"ion-grid",2),e.nrm(4,"ion-grid",3),e.k0s()(),e.j41(5,"ion-row")(6,"div",4),e.nrm(7,"img",5),e.k0s()()(),e.j41(8,"ion-grid",6)(9,"ion-grid",7)(10,"ion-grid",8),e.nrm(11,"ion-icon",9),e.j41(12,"ion-input",10),e.mxI("ngModelChange",function(i){return e.DH7(n.outlet_code,i)||(n.outlet_code=i),i}),e.k0s()(),e.j41(13,"ion-grid",8),e.nrm(14,"ion-icon",11),e.j41(15,"ion-input",12),e.mxI("ngModelChange",function(i){return e.DH7(n.username,i)||(n.username=i),i}),e.k0s()(),e.j41(16,"ion-grid",8),e.nrm(17,"ion-icon",13),e.j41(18,"ion-input",14),e.mxI("ngModelChange",function(i){return e.DH7(n.password,i)||(n.password=i),i}),e.k0s(),e.j41(19,"span")(20,"ion-icon",15),e.bIt("click",function(){return n.togglePasswordVisibility()}),e.k0s()()(),e.j41(21,"button",16),e.bIt("click",function(){return n.Login()}),e.EFF(22,"Login"),e.k0s(),e.j41(23,"div",17)(24,"p"),e.EFF(25,"Belum punya akun?"),e.k0s(),e.j41(26,"button",18),e.bIt("click",function(){return n.register()}),e.EFF(27,"Registrasi Sekarang"),e.k0s()(),e.j41(28,"ion-grid",19)(29,"ion-grid",20),e.nrm(30,"ion-grid",21),e.k0s()(),e.nrm(31,"div",22),e.k0s()()()),2&t&&(e.R7$(12),e.R50("ngModel",n.outlet_code),e.R7$(3),e.R50("ngModel",n.username),e.R7$(3),e.R50("ngModel",n.password),e.Y8G("type",n.showPassword?"text":"password"),e.R7$(2),e.Y8G("name",n.showPassword?"eye":"eye-off"))},dependencies:[d.BC,d.YS,d.vS,s.W9,s.lO,s.iq,s.$w,s.ln,s.Gw],styles:["ion-content[_ngcontent-%COMP%]{--background: white;height:auto}.banner[_ngcontent-%COMP%]{position:relative;background:#febb4b;padding:0;margin:0;border-radius:0 0 0 40px;width:100%;overflow:hidden}ion-title[_ngcontent-%COMP%]{text-align:center;padding:5rem 0;font-size:3rem;font-family:Megrim;font-weight:900}.img[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;align-items:center;padding:6rem 0 4rem}.img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60%}.top-circle-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:end;right:-2rem;top:-2.5rem;bottom:0;z-index:2}.top-circle[_ngcontent-%COMP%]{width:8rem;height:8rem;background-color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;padding:2.5rem;position:absolute}.pattern[_ngcontent-%COMP%]{position:relative;width:100%;padding:0;margin:0;top:0}.food[_ngcontent-%COMP%]{position:absolute;top:0;width:100%}.top-circle-inside[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background-color:#cf8f24}.login-container[_ngcontent-%COMP%]{border-radius:0 40px 0 0;padding:1.2rem 0 0;background:linear-gradient(to top right,#fffbf3,#fff);display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:auto;overflow:hidden}ion-icon[_ngcontent-%COMP%]{color:#454545;font-size:1.5rem}ion-input[_ngcontent-%COMP%]{--placeholder-color: black;--placeholder-font-size: 1rem}.input-container[_ngcontent-%COMP%]{color:#454545;background:#fff;width:80%;padding:.5rem 1.5rem;margin:.5rem 0;text-align:start;box-shadow:0 5px 7px #00000038;border-radius:15px;display:flex;align-items:center;justify-content:center;gap:10px}.input-btn[_ngcontent-%COMP%]{width:70%;height:auto;padding:15px 0;color:#fff;font-size:1rem;font-weight:700;background:#cf8f24;border-radius:15px;margin-top:1rem}.register-link[_ngcontent-%COMP%]{font-size:14px;color:#454545;text-align:center;display:flex;justify-content:center;align-items:center;gap:7px;padding-bottom:5rem}.register-link[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;color:#0091ff}.footer[_ngcontent-%COMP%]{width:100%;height:3rem;background-color:#ffdea7}.bottom-circle-container[_ngcontent-%COMP%]{position:relative;display:flex;width:100%;justify-content:start;left:-2rem;bottom:5rem;z-index:2}.bottom-circle[_ngcontent-%COMP%]{width:9rem;height:9rem;background-color:#cf8f24;border-radius:50%;display:flex;justify-content:center;align-items:center;padding:2.5rem;position:absolute}.bottom-circle-inside[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background-color:#fff}"]}),l})()}];let v=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[m.iI.forChild(P),m.iI]}),l})(),w=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.MD,d.YN,s.bv,v]}),l})()}}]);